"use strict";(self.webpackChunkway23=self.webpackChunkway23||[]).push([[5100],{90356:(n,s,a)=>{a.r(s),a.d(s,{data:()=>p});const p={key:"v-60818c08",path:"/%D0%BF%D0%BE%D0%B2%D0%B5%D1%80%D1%85%D0%BD%D0%BE%D1%81%D1%82%D0%BD%D0%BE%D0%B5-%D0%B8-%D0%B3%D0%BB%D1%83%D0%B1%D0%BE%D0%BA%D0%BE%D0%B5-%D0%BA%D0%BE%D0%BF%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8.html",title:"Поверхностное и глубокое копирование в Python",lang:"ru-RU",frontmatter:{title:"Поверхностное и глубокое копирование в Python",date:"2020-02-26",categories:["Python"],tags:["Python","перевод"]},excerpt:"",headers:[{level:2,title:"Копирование объектов в Python",slug:"копирование-объектов-в-python",children:[]},{level:2,title:"Модуль Copy",slug:"модуль-copy",children:[]},{level:2,title:"Поверхностное копирование",slug:"поверхностное-копирование",children:[]},{level:2,title:"Глубокое копирование",slug:"глубокое-копирование",children:[]}],filePathRelative:"поверхностное-и-глубокое-копировани.md",git:{updatedTime:1692859375e3}}},98378:(n,s,a)=>{a.r(s),a.d(s,{default:()=>k});var p=a(66252),t=a(3577);const e={id:"frontmatter-title",tabindex:"-1"},o=(0,p._)("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),c=(0,p.Uk)("Перевод статьи "),l={href:"https://www.programiz.com/python-programming/shallow-deep-copy",target:"_blank",rel:"noopener noreferrer"},u=(0,p.Uk)("Python Shallow Copy and Deep Copy"),i=(0,p.Uk)("."),r=(0,p.uE)('<h2 id="копирование-объектов-в-python" tabindex="-1"><a class="header-anchor" href="#копирование-объектов-в-python" aria-hidden="true">#</a> Копирование объектов в Python</h2><p>Оператор присваивания <code>=</code> не создаёт копию объекта. Присваивание создаёт новую переменную которая дублирует ссылку на исходный объект.</p><p>Рассмотрим пример</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>old_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&#39;a&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nnew_list <span class="token operator">=</span> old_list\n\nnew_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Old List:&#39;</span><span class="token punctuation">,</span> old_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;ID of Old List:&#39;</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>old_list<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;New List:&#39;</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;ID of New List:&#39;</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>new_list<span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>После запуска программа выдаст следующее:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Old List: [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nID of Old List: 140673303268168\n\nNew List: [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nID of New List: 140673303268168\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Обе переменные ссылаются на один объект, это подтверждает одинаковый идентификатор объекта 140673303268168. Так что при изменении значений в переменных <code>new_list</code> и <code>old_list</code>, изменение будет видно в обоих переменных.</p><p>Иногда нужно оставить исходное значение без изменений и модифицировать только новое. В Python, есть два способа сделать копию: поверхностное копирование и глубокое копирование.</p><h2 id="модуль-copy" tabindex="-1"><a class="header-anchor" href="#модуль-copy" aria-hidden="true">#</a> Модуль Copy</h2><p>Модуль <code>copy</code> используется для поверхностного и глубокого копирования. Например:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> copy\n\ncopy<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>x<span class="token punctuation">)</span>\ncopy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>x<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Метод <code>copy()</code> возвращает поверхностную копию <code>x</code>, а метод <code>deepcopy()</code> возвращает глубокую копию <code>x</code>.</p><h2 id="поверхностное-копирование" tabindex="-1"><a class="header-anchor" href="#поверхностное-копирование" aria-hidden="true">#</a> Поверхностное копирование</h2><p>Поверхностное копирование создаёт новый объект и копирует ссылки на все вложенные объекты. Это означает что процесс копирования не рекурсивный и не создаёт копий вложенных объектов.</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> copy\n\nold_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nnew_list <span class="token operator">=</span> copy<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>old_list<span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Old list:&quot;</span><span class="token punctuation">,</span> old_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;New list:&quot;</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Вывод программы:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Old list: [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nNew list: [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>В программе выше, мы создали вложенный список и его поверхностную копию методом <code>copy()</code>. Это означает что мы создали независимый объект с тем же содержимым.</p><p>Чтобы проверить что объекты разные добавим в один из списков новый элемент:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> copy\n\nold_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nnew_list <span class="token operator">=</span> copy<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>old_list<span class="token punctuation">)</span>\n\nold_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Old list:&quot;</span><span class="token punctuation">,</span> old_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;New list:&quot;</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Вывод программы:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Old list: [[1, 1, 1], [2, 2, 2], [3, 3, 3], [4, 4, 4]]\nNew list: [[1, 1, 1], [2, 2, 2], [3, 3, 3]]\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Изменения в исходном списке (<code>old_list</code>) не повлияли на новый список (<code>new_list</code>).</p><p>Попробуем изменить один из вложенных объектов:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> copy\n\nold_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nnew_list <span class="token operator">=</span> copy<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>old_list<span class="token punctuation">)</span>\n\nold_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;AA&#39;</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Old list:&quot;</span><span class="token punctuation">,</span> old_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;New list:&quot;</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Вывод программы:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Old list: [[1, 1, 1], [2, &#39;AA&#39;, 2], [3, 3, 3]]\nNew list: [[1, 1, 1], [2, &#39;AA&#39;, 2], [3, 3, 3]]\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Мы изменили вложенный в в оригинальный объект список (<code>old_list[1]</code>). Так как ссылки на вложенные элементы в двух списках одинаковые, изменение вложенного списка отразилось и на <code>old_list</code> и на <code>new_list</code>.</p><h2 id="глубокое-копирование" tabindex="-1"><a class="header-anchor" href="#глубокое-копирование" aria-hidden="true">#</a> Глубокое копирование</h2><p>Глубокое копирование создаёт новый объект и рекурсивно добавляет в него копии вложенных объектов из исходного объекта.</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> copy\n\nold_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nnew_list <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>old_list<span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Old list:&quot;</span><span class="token punctuation">,</span> old_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;New list:&quot;</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Вывод программы:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Old list: [[1, 1, 1], [2, 2, 2], [3, 3, 3]]\nNew list: [[1, 1, 1], [2, 2, 2], [3, 3, 3]]\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>В этом примере не видно отличий от использования функции <code>copy()</code>. Изменения видны если модифицировать вложенный список:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> copy\n\nold_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nnew_list <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>old_list<span class="token punctuation">)</span>\n\nold_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;BB&#39;</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Old list:&quot;</span><span class="token punctuation">,</span> old_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;New list:&quot;</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Вывод программы:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Old list: [[1, 1, 1], [&#39;BB&#39;, 2, 2], [3, 3, 3]]\nNew list: [[1, 1, 1], [2, 2, 2], [3, 3, 3]]\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Изменения видны только в списке <code>old_list</code>, так как список <code>new_list</code> содержит копии всех вложенных объектов.</p>',38),k={render:function(n,s){const a=(0,p.up)("OutboundLink");return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p._)("h1",e,[o,(0,p.Uk)(" "+(0,t.zw)(n.$frontmatter.title),1)]),(0,p._)("p",null,[c,(0,p._)("a",l,[u,(0,p.Wm)(a)]),i]),r],64)}}}}]);