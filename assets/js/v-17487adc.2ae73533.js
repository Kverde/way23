"use strict";(self.webpackChunkway23=self.webpackChunkway23||[]).push([[4076],{94982:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-17487adc",path:"/db-elasticsearch.html",title:"Базы данных: ElasticSearch",lang:"ru-RU",frontmatter:{title:"Базы данных: ElasticSearch",date:"2025-01-05",categories:["Базы данных"],tags:["ElasticSearch","Поисковый движок"]},excerpt:"",headers:[{level:2,title:"Запуск",slug:"запуск",children:[]},{level:2,title:"Проверка работы",slug:"проверка-работы",children:[]},{level:2,title:"Пример на Python",slug:"пример-на-python",children:[]},{level:2,title:"Ссылки",slug:"ссылки",children:[]}],filePathRelative:"db-elasticsearch.md",git:{updatedTime:173607323e4}}},58347:(n,s,a)=>{a.r(s),a.d(s,{default:()=>D});var t=a(66252),p=a(3577);const e={id:"frontmatter-title",tabindex:"-1"},o=(0,t._)("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),c={href:"https://www.elastic.co/elasticsearch",target:"_blank",rel:"noopener noreferrer"},l=(0,t.Uk)("ElasticSearch"),u=(0,t.Uk)(" — поисковый движок, хранит документы, строит по ним индексы и позволяет быстро искать документы по набору условий. Под документом следует понимать набор полей по которым производится поиск. Индекс, в контексте ElasticSearch, не то же самое, что индекс в реляционной БД, а скорее именованная коллекция документов."),r=(0,t._)("h2",{id:"запуск",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#запуск","aria-hidden":"true"},"#"),(0,t.Uk)(" Запуск")],-1),i=(0,t.Uk)("Запустить ElasticSearch проще всего через "),k={href:"https://hub.docker.com/_/elasticsearch",target:"_blank",rel:"noopener noreferrer"},b=(0,t.Uk)("docker"),m=(0,t.Uk)("."),d=(0,t.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run -d --name elasticsearch \\\n    -p 9200:9200 -p 9300:9300 \\\n    -e &quot;discovery.type=single-node&quot; \\\n    -e &quot;xpack.security.enabled=false&quot; \\\n    elasticsearch:8.6.2\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="проверка-работы" tabindex="-1"><a class="header-anchor" href="#проверка-работы" aria-hidden="true">#</a> Проверка работы</h2><p>Для проверки работы обратитесь в браузере к порту <code>http://localhost:9200</code> или командой</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -X GET localhost:9200\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>В результате будет получен JSON с информацией о сервере:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;10fb6274b140&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;cluster_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;docker-cluster&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;cluster_uuid&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;NJx2y2iiSJizhkWQHA0zwg&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;version&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;number&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;8.6.2&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;build_flavor&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;build_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;docker&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;build_hash&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2d58d0f136141f03239816a4e360a8d17b6d8f29&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;build_date&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2023-02-13T09:35:20.314882762Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;build_snapshot&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;lucene_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;9.4.2&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;minimum_wire_compatibility_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;7.17.0&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;minimum_index_compatibility_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;7.0.0&quot;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;tagline&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="пример-на-python" tabindex="-1"><a class="header-anchor" href="#пример-на-python" aria-hidden="true">#</a> Пример на Python</h2>',7),q=(0,t.Uk)("Пример использования библиотеки "),h={href:"https://github.com/elastic/elasticsearch-py",target:"_blank",rel:"noopener noreferrer"},g=(0,t.Uk)("elasticsearch"),y=(0,t.Uk)(":"),_=(0,t.uE)('<div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> elasticsearch <span class="token keyword">import</span> Elasticsearch\n\n<span class="token comment"># Подключение к Elasticsearch</span>\nes <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">&quot;http://debian-server:9200&quot;</span><span class="token punctuation">)</span>\n\n<span class="token comment"># Проверка подключения</span>\n<span class="token keyword">if</span> <span class="token keyword">not</span> es<span class="token punctuation">.</span>ping<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Elasticsearch не доступен!&quot;</span><span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Подключение к Elasticsearch успешно!&quot;</span><span class="token punctuation">)</span>\n\n<span class="token comment"># Создание нового индекса</span>\nindex_name <span class="token operator">=</span> <span class="token string">&quot;my_documents3&quot;</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    es<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>create<span class="token punctuation">(</span>index<span class="token operator">=</span>index_name<span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Индекс &#39;</span><span class="token interpolation"><span class="token punctuation">{</span>index_name<span class="token punctuation">}</span></span><span class="token string">&#39; успешно создан.&quot;</span></span><span class="token punctuation">)</span>\n<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Индекс уже существует или произошла ошибка: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>\n\n<span class="token comment"># Добавление документов с разнообразным английским текстом</span>\ndocuments <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Document 1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;The quick brown fox jumps over the lazy dog.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Document 2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Artificial intelligence is transforming the world.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Document 3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;The universe is vast and full of mysteries.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Document 4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Cooking is an art that requires creativity and passion.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Document 5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Traveling opens your mind to new cultures and experiences.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> doc <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>documents<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    es<span class="token punctuation">.</span>index<span class="token punctuation">(</span>index<span class="token operator">=</span>index_name<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span>i<span class="token punctuation">,</span> document<span class="token operator">=</span>doc<span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Документы добавлены!&quot;</span><span class="token punctuation">)</span>\n\n<span class="token comment"># Явный вызов refresh для обновления индекса</span>\nes<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span>index<span class="token operator">=</span>index_name<span class="token punctuation">)</span>\n\n<span class="token comment"># Проверка количества документов в индексе</span>\ndoc_count <span class="token operator">=</span> es<span class="token punctuation">.</span>count<span class="token punctuation">(</span>index<span class="token operator">=</span>index_name<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Количество документов в индексе &#39;</span><span class="token interpolation"><span class="token punctuation">{</span>index_name<span class="token punctuation">}</span></span><span class="token string">&#39;: </span><span class="token interpolation"><span class="token punctuation">{</span>doc_count<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>\n\n<span class="token comment"># Поиск документов</span>\nsearch_query <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">&quot;match&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;art&quot;</span>  <span class="token comment"># Ищем слово &quot;art&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\nresponse <span class="token operator">=</span> es<span class="token punctuation">.</span>search<span class="token punctuation">(</span>index<span class="token operator">=</span>index_name<span class="token punctuation">,</span> body<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;query&quot;</span><span class="token punctuation">:</span> search_query<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Результаты поиска:&quot;</span><span class="token punctuation">)</span>\n<span class="token keyword">for</span> hit <span class="token keyword">in</span> response<span class="token punctuation">[</span><span class="token string">&#39;hits&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;hits&#39;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ID: </span><span class="token interpolation"><span class="token punctuation">{</span>hit<span class="token punctuation">[</span><span class="token string">&#39;_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">, Title: </span><span class="token interpolation"><span class="token punctuation">{</span>hit<span class="token punctuation">[</span><span class="token string">&#39;_source&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">, Content: </span><span class="token interpolation"><span class="token punctuation">{</span>hit<span class="token punctuation">[</span><span class="token string">&#39;_source&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;content&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>Ввод программы:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Подключение к Elasticsearch успешно!\nИндекс &#39;my_documents3&#39; успешно создан.\nДокументы добавлены!\nКоличество документов в индексе &#39;my_documents3&#39;: 5\nРезультаты поиска:\nID: 3, Title: Document 4, Content: Cooking is an art that requires creativity and passion.\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="ссылки" tabindex="-1"><a class="header-anchor" href="#ссылки" aria-hidden="true">#</a> Ссылки</h2>',4),f={href:"https://www.youtube.com/watch?v=vxE1aGTEnbE",target:"_blank",rel:"noopener noreferrer"},v=(0,t.Uk)("ElasticSearch: Всё, что нужно знать за 30 минут"),w={href:"https://doka-guide.vercel.app/tools/elasticsearch/",target:"_blank",rel:"noopener noreferrer"},x=(0,t.Uk)("Основы работы с Elasticsearch"),E=(0,t.Uk)(" — пример на NodeJS"),U={href:"https://www.youtube.com/playlist?list=PLlKID9PnOE5jzJmRYfY0Rs1axrlH4-Qe_",target:"_blank",rel:"noopener noreferrer"},S=(0,t.Uk)("Плейлист ElasticSearch для самых маленьких python-разработчиков"),D={render:function(n,s){const a=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("h1",e,[o,(0,t.Uk)(" "+(0,p.zw)(n.$frontmatter.title),1)]),(0,t._)("p",null,[(0,t._)("a",c,[l,(0,t.Wm)(a)]),u]),r,(0,t._)("p",null,[i,(0,t._)("a",k,[b,(0,t.Wm)(a)]),m]),d,(0,t._)("p",null,[q,(0,t._)("a",h,[g,(0,t.Wm)(a)]),y]),_,(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("a",f,[v,(0,t.Wm)(a)])]),(0,t._)("li",null,[(0,t._)("a",w,[x,(0,t.Wm)(a)]),E]),(0,t._)("li",null,[(0,t._)("a",U,[S,(0,t.Wm)(a)])])])],64)}}}}]);