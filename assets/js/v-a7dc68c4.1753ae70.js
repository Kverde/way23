"use strict";(self.webpackChunkway23=self.webpackChunkway23||[]).push([[9522],{56471:(n,e,s)=>{s.r(e),s.d(e,{data:()=>a});const a={key:"v-a7dc68c4",path:"/db-eventstoredb.html",title:"Базы данных: EventStoreDB",lang:"ru-RU",frontmatter:{title:"Базы данных: EventStoreDB",date:"2024-12-30",categories:["Базы данных"],tags:["EventStoreDB","Ключ-значение","Event sourcing"]},excerpt:"",headers:[{level:2,title:"Запуск",slug:"запуск",children:[]},{level:2,title:"Event Store Navigator",slug:"event-store-navigator",children:[]},{level:2,title:"Пример на Python",slug:"пример-на-python",children:[]},{level:2,title:"Ссылки",slug:"ссылки",children:[]}],filePathRelative:"db-eventstoredb.md",git:{updatedTime:1735583365e3}}},64444:(n,e,s)=>{s.r(e),s.d(e,{default:()=>U});var a=s(66252),t=s(3577);const r={id:"frontmatter-title",tabindex:"-1"},p=(0,a._)("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),o={href:"https://github.com/EventStore/EventStore",target:"_blank",rel:"noopener noreferrer"},l=(0,a.Uk)("EventStoreDB"),c=(0,a.Uk)(" — база данных для хранения событий (изменений состояний объектов), например, для реализации шаблона "),u={href:"https://microservices.io/patterns/data/event-sourcing.html",target:"_blank",rel:"noopener noreferrer"},i=(0,a.Uk)("Event sourcing"),b=(0,a.Uk)("."),d=(0,a.uE)('<p>Основные объекты EventStoreDB:</p><ul><li>Событие (event) — основной объект в котором хранятся данные. Событие имеет тип — группа событий имеющих одно назначение, например, <code>пополнение счёта</code>, <code>изменение данных</code> и подобные. Данные хранятся в виде набора байт (чаще всего json).</li><li>Поток (stream) — объект к которому привязываются события. Это может быть некоторый общий объект вроде <code>application</code>, или же это может быть определенный объект с идентификатором такой как <code>user-123</code>.</li></ul><p>Логически EventStoreDB представляет из себя key-value хранилище, где key это название потока, а value — список событий. Так же эту базу данных можно представить в виде последовательно добавляемых записей лога.</p><h2 id="запуск" tabindex="-1"><a class="header-anchor" href="#запуск" aria-hidden="true">#</a> Запуск</h2>',4),k=(0,a.Uk)("Запустить EventStoreDB проще всего через "),m={href:"https://hub.docker.com/r/eventstore/eventstore",target:"_blank",rel:"noopener noreferrer"},h=(0,a.Uk)("docker"),v=(0,a.Uk)("."),g=(0,a.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run --name esdb -d -p 2113:2113 \\\n    eventstore/eventstore:latest --insecure --run-projections=All \\\n    --enable-atom-pub-over-http\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="event-store-navigator" tabindex="-1"><a class="header-anchor" href="#event-store-navigator" aria-hidden="true">#</a> Event Store Navigator</h2><p>EventStoreDB поддерживает web-интерфейс для администрирования. После запуска контейнера интерфейс будет доступен по адресу <code>localhost:2113</code>.</p><p>На вкладке <code>Stream Browser</code> можно увидеть недавно изменённые потоки и добавить событие в любой поток.</p><h2 id="пример-на-python" tabindex="-1"><a class="header-anchor" href="#пример-на-python" aria-hidden="true">#</a> Пример на Python</h2>',5),f=(0,a.Uk)("Пример использования библиотеки "),_={href:"https://github.com/pyeventsourcing/esdbclient",target:"_blank",rel:"noopener noreferrer"},y=(0,a.Uk)("esdbclient"),E=(0,a.Uk)(":"),S=(0,a.uE)('<div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> esdbclient <span class="token keyword">import</span> EventStoreDBClient<span class="token punctuation">,</span> NewEvent<span class="token punctuation">,</span> StreamState\n\nclient <span class="token operator">=</span> EventStoreDBClient<span class="token punctuation">(</span>\n    uri<span class="token operator">=</span><span class="token string">&quot;esdb://localhost:2113?Tls=false&quot;</span>\n<span class="token punctuation">)</span>\n\nevent1 <span class="token operator">=</span> NewEvent<span class="token punctuation">(</span>\n    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&#39;PartProduced&#39;</span><span class="token punctuation">,</span>\n    data<span class="token operator">=</span><span class="token string">b&#39;{&quot;count&quot;: &quot;3&quot;}&#39;</span>\n<span class="token punctuation">)</span>\n\nevent2 <span class="token operator">=</span> NewEvent<span class="token punctuation">(</span>\n    <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">&#39;PartProduced&#39;</span><span class="token punctuation">,</span>\n    data<span class="token operator">=</span><span class="token string">b&#39;{&quot;count&quot;: &quot;5&quot;}&#39;</span>\n<span class="token punctuation">)</span>\n\nclient<span class="token punctuation">.</span>append_to_stream<span class="token punctuation">(</span>\n    stream_name<span class="token operator">=</span><span class="token string">&#39;machine-25&#39;</span><span class="token punctuation">,</span>\n    events<span class="token operator">=</span><span class="token punctuation">[</span>event1<span class="token punctuation">,</span> event2<span class="token punctuation">]</span><span class="token punctuation">,</span>\n    current_version<span class="token operator">=</span>StreamState<span class="token punctuation">.</span>ANY\n<span class="token punctuation">)</span>\n\nevents <span class="token operator">=</span> client<span class="token punctuation">.</span>get_stream<span class="token punctuation">(</span><span class="token string">&#39;machine-25&#39;</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data <span class="token keyword">for</span> event <span class="token keyword">in</span> events<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment"># [b&#39;{&quot;count&quot;: &quot;3&quot;}&#39;, b&#39;{&quot;count&quot;: &quot;5&quot;}&#39;]</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="ссылки" tabindex="-1"><a class="header-anchor" href="#ссылки" aria-hidden="true">#</a> Ссылки</h2>',2),w={href:"https://www.youtube.com/playlist?list=PLWG5TK2D4U_Nb4rWdiQw2jNWYSaBm7lT_",target:"_blank",rel:"noopener noreferrer"},q=(0,a.Uk)("Плейлист EventStoreDB Training Series"),U={render:function(n,e){const s=(0,a.up)("OutboundLink");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("h1",r,[p,(0,a.Uk)(" "+(0,t.zw)(n.$frontmatter.title),1)]),(0,a._)("p",null,[(0,a._)("a",o,[l,(0,a.Wm)(s)]),c,(0,a._)("a",u,[i,(0,a.Wm)(s)]),b]),d,(0,a._)("p",null,[k,(0,a._)("a",m,[h,(0,a.Wm)(s)]),v]),g,(0,a._)("p",null,[f,(0,a._)("a",_,[y,(0,a.Wm)(s)]),E]),S,(0,a._)("ul",null,[(0,a._)("li",null,[(0,a._)("a",w,[q,(0,a.Wm)(s)])])])],64)}}}}]);