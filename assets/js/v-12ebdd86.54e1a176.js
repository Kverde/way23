"use strict";(self.webpackChunkway23=self.webpackChunkway23||[]).push([[8884],{21386:(n,s,e)=>{e.r(s),e.d(s,{data:()=>a});const a={key:"v-12ebdd86",path:"/%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B3%D0%BE-dsl-%D0%BA%D0%BE%D0%BC%D0%BF%D0%B8%D0%BB%D1%8F%D1%82%D0%BE%D1%80%D0%B0-%D0%BD%D0%B0-delphi-inte.html",title:"–ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ DSL –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –Ω–∞ Delphi (Intermezzo)",lang:"ru-RU",frontmatter:{title:"–ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ DSL –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ –Ω–∞ Delphi (Intermezzo)",date:"2019-06-10",categories:["Delphi"],tags:["Delphi","–ø–µ—Ä–µ–≤–æ–¥","–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã","–≥—Ä–∞–º–æ—Ç–Ω–æ–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"]},excerpt:"",headers:[{level:2,title:"introduction.dpr",slug:"introduction-dpr",children:[]}],filePathRelative:"–Ω–∞–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ—Å—Ç–æ–≥–æ-dsl-–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞-–Ω–∞-delphi-inte.md",git:{updatedTime:1692859375e3}}},64609:(n,s,e)=>{e.r(s),e.d(s,{default:()=>F});var a=e(66252),r=e(3577);const l={id:"frontmatter-title",tabindex:"-1"},p=(0,a._)("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),i=(0,a.Uk)("–ü–µ—Ä–µ–≤–æ–¥ –ø–æ—Å—Ç–∞ "),b={href:"https://www.thedelphigeek.com/2017/10/writing-simple-dsl-compiler-with-delphi_17.html",target:"_blank",rel:"noopener noreferrer"},t=(0,a.Uk)("Writing a Simple DSL Compiler with Delphi (Intermezzo)"),c=(0,a.Uk)("."),u=(0,a.Uk)("–ö–æ–≥–¥–∞ —è –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–ª —Å—Ç–∞—Ç—å—é –ø—Ä–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–ª—è –º–æ–µ–≥–æ "),m={href:"http://way23.ru/%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B3%D0%BE-dsl-%D0%BA%D0%BE%D0%BC%D0%BF%D0%B8%D0%BB%D1%8F%D1%82%D0%BE%D1%80%D0%B0-%D0%BD%D0%B0-delphi-0/",target:"_blank",rel:"noopener noreferrer"},d=(0,a.Uk)("–∏–≥—Ä—É—à–µ—á–Ω–æ–≥–æ —è–∑—ã–∫–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞"),o=(0,a.Uk)(", —è –æ–±–Ω–∞—Ä—É–∂–∏–ª —á—Ç–æ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –æ–±—ë—Ä—Ç–∫–∏ —Ü–µ–ª–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ —Å–≤—è–∑–∫—É –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (—á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä) —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ —Å–ª–æ–∂–Ω–∞ –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è. –ü–æ—ç—Ç–æ–º—É —è –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª —É–ø—Ä–æ—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω—É—é –¥–ª—è –æ—á–µ–Ω—å —É–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞... –∞ –∑–∞—Ç–µ–º —è —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏ –¥–æ–±–∞–≤–∏–ª AST, –ø–∞–∫—Ä—Å–µ—Ä –∏ —Ç–æ–∫–∏–Ω–µ–∑–∞—Ç–æ—Ä."),g=(0,a.Uk)("–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤—Å–µ–≥–æ —ç—Ç–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ "),T={href:"https://github.com/gabr42/SimpleDSLCompiler/blob/master/introduction.dpr",target:"_blank",rel:"noopener noreferrer"},h=(0,a.Uk)("introduction.dpr"),v=(0,a.Uk)(", –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —è–∑—ã–∫ (–æ—á–µ–Ω—å —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π) –≤–º–µ—Å—Ç–µ —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π, –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –≤ —Å—Ç–∏–ª–µ "),A={href:"https://ru.wikipedia.org/wiki/%D0%93%D1%80%D0%B0%D0%BC%D0%BE%D1%82%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5",target:"_blank",rel:"noopener noreferrer"},x=(0,a.Uk)("–ì—Ä–∞–º–æ—Ç–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è"),C=(0,a.Uk)(". –£–ø—Ä–æ—â–µ–Ω–æ ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ —á–∏—Ç–∞—Ç—å –µ—ë —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑ –∫–∞–∫ –∏—Å—Ç–æ—Ä–∏—é."),k=(0,a.uE)('<p>–í –∫–∞—á–µ—Å—Ç–≤–µ intermezzo –∏ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –º–æ–µ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, —è –æ–ø–∏—à—É —ç—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—É –∑–¥–µ—Å—å –ø–æ–ª–Ω–æ—Å—Ç—å—é, –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–≤ –µ—ë –∫–∞–∫ –ø–æ—Å—Ç –≤ –±–ª–æ–≥.</p><h2 id="introduction-dpr" tabindex="-1"><a class="header-anchor" href="#introduction-dpr" aria-hidden="true">#</a> introduction.dpr</h2><p>–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —è–≤–ª—è–µ—Ç—Å—è –º—è–≥–∫–∏–º –≤–≤–µ–¥–µ–Ω–∏–µ–º –≤ —Ç–µ–º—É &quot;compiler-compiler&quot; (–ø—Ä–æ–≥—Ä–∞–º–º –∫–æ—Ç–æ—Ä—ã–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã –∏–ª–∏ –∏—Ö —á–∞—Å—Ç–∏). –û–Ω–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –≤ —Å—Ç–∏–ª–µ –ì—Ä–∞–º–æ—Ç–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>program introduction;\n{$APPTYPE CONSOLE}\n{$R *.res}\nuses\n  System.SysUtils,\n  System.Classes,\n  System.Character,\n\n  System.Generics.Collections;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>–ù–∞—à–∞ –∑–∞–¥–∞—á–∞: –º—ã —Ö–æ—Ç–∏–º –≤—ã—á–∏—Å–ª—è—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–µ</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>   number1 + number2 + ... + numberN\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>–í—Å–µ —á–∏—Å–ª–∞ —Ü–µ–ª—ã–µ –∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ, —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä ‚Äî —Å–ª–æ–∂–µ–Ω–∏–µ, –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.</p><p>–§–æ—Ä–º–∞–ª—å–Ω–æ, –º—ã –º–æ–∂–µ–º –æ–ø–∏—Å–∞—Ç—å –Ω–∞—à—É –ø—Ä–æ–≥—Ä–∞–º–º—É —Å–ª–µ–¥—É—é—â–µ–π –≥—Ä–∞–º–º–∞—Ç–∏–∫–æ–π</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>S ‚Üí Term\nTerm ‚Üí number\nTerm ‚Üí Term &#39;+&#39; Term\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>–ü—Ä–æ–±–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –ø–∞—Ä—Å–µ—Ä–æ–º –∏ —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –Ω–µ —è–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç—å—é –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏.</p><p>–ú—ã –Ω–∞—á–Ω—ë–º —Å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–≥–æ AST –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ–≥—Ä–∞–º–º—ã</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>type\n  TTerm = class abstract\n  end; \n\n  TAST = TTerm;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>–ù–∞ –≤–µ—Ä—Ö—É –Ω–∞—à–µ–≥–æ –¥–µ—Ä–µ–≤–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è &#39;term&#39; (—Å–ª–∞–≥–∞–µ–º–æ–µ). <em>–°–ª–∞–≥–∞–µ–º–æ–µ</em> –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ <em>–∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π</em> –ª–∏–±–æ <em>—Å–ª–æ–∂–µ–Ω–∏–µ–º</em>.</p><p><em>–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞</em>, –∫–∞–∫ –∏ –º–æ–∂–Ω–æ –æ–∂–∏–¥–∞—Ç—å, —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.</p><p>–ó–¥–µ—Å—å –º—ã –Ω–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã ‚Äî —è–∑—ã–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —á–∏—Å–ª–∞, –Ω–æ AST –±–æ–ª–µ–µ –æ–±—â–µ–µ –∏ –¥–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —á–∏—Å–ª–∞. –ú—ã –±—É–¥–µ–º –ø—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>  TConstant = class(TTerm)\n  strict private\n    FValue: integer;\n  public\n    constructor Create(AValue: integer);\n    property Value: integer read FValue write FValue;\n  end;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><em>–°–ª–æ–∂–µ–Ω–∏–µ</em> ‚Äî –±–∏–Ω–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–∞–¥ –¥–≤—É–º—è <em>—Å–ª–∞–≥–∞–µ–º—ã–º–∏</em> (–ª–µ–≤—ã–º –∏ –ø—Ä–∞–≤—ã–º).</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>  TAddition = class(TTerm)\n  strict private\n    FTerm1: TTerm;\n    FTerm2: TTerm;\n  public\n    constructor Create(ATerm1, ATerm2: TTerm);\n    destructor  Destroy; override;\n    property Term1: TTerm read FTerm1 write FTerm1;\n    property Term2: TTerm read FTerm2 write FTerm2;\n  end;\n\nconstructor TConstant.Create(AValue: integer);\nbegin\n  inherited Create;\n  FValue := AValue;\nend;\n\nconstructor TAddition.Create(ATerm1, ATerm2: TTerm);\nbegin\n  inherited Create;\n  FTerm1 := ATerm1;\n  FTerm2 := ATerm2;\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>–û–±—ä–µ–∫—Ç <code>TAddition</code> —è–≤–ª—è–µ—Ç—Å—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–º —Å–≤–æ–∏—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>destructor TAddition.Destroy;\nbegin\n  FreeAndNil(FTerm1);\n  FreeAndNil(FTerm2);\n  inherited;\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>–°–ª–µ–¥—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–æ–∏—Ç AST –∏–∑ –º–∞—Å—Å–∏–≤–∞ —á–∏—Å–µ–ª. –í–ª–∞–¥–µ–ª–µ—Ü –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ AST.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function CreateAST(const values: TArray): TAST;\nvar\n  iValue: integer;\nbegin\n  if Length(values) = 0 then\n\n    Exit(nil);\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>–ú—ã –±—É–¥–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å <em>—Å–ª–∞–≥–∞–µ–º—ã–µ</em> –∏–∑ –º–∞—Å—Å–∏–≤ –≤ –Ω–∞—á–∏–Ω–∞—è —Å –∫–æ–Ω—Ü–∞ –∫ –Ω–∞—á–∞–ª—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∫ —Å–ª–∞–≥–∞–µ–º—ã–µ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–∞–≥–∞–µ–º—ã—Ö.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>  Result := TConstant.Create(values[High(values)]);\n\n  for iValue := High(values) - 1 downto Low(values) do\n    Result := TAddition.Create(TConstant.Create(values[iValue]), Result);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>–í—ã–∑–æ–≤ <code>CreateAST([1, 2, 3])</code> —Å–æ–∑–¥–∞—Å—Ç —Å–ª–µ–¥—É—é—â–µ–µ AST —Å —Ç—Ä–µ–º—è —É–∑–ª–∞–º–∏:</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>TAddition\n   Term1 = TConstant\n           Value = 1\n   Term2 = TAddition\n           Term1 = TConstant\n                   Value = 2\n           Term2 = TConstant\n                   Value = 3\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>–î–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º –∏–∑ —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç.</p><p>–°–Ω–∞—á–∞–ª–∞, –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—é—Ç —Ç–∏–ø.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function IsConstant(term: TTerm; out add: TConstant): boolean;\nbegin\n  Result := term is TConstant;\n  if Result then\n    add := TConstant(term);\nend;\n\nfunction IsAddition(term: TTerm; out add: TAddition): boolean;\nbegin\n  Result := term is TAddition;\n  if Result then\n    add := TAddition(term);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>–ò —Ç–µ–ø–µ—Ä—å —Ä–µ–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure TestCreateAST;\nvar\n  add1  : TAddition;\n  add2  : TAddition;\n  ast   : TAST;\n  const1: TConstant;\n  const2: TConstant;\n  const3: TConstant;\nbegin\n  ast := CreateAST([1, 2, 3]);\n  try\n    if assigned(ast)\n       and IsAddition(ast, add1)\n       and IsConstant(add1.Term1, const1) and (const1.Value = 1)\n       and IsAddition(add1.Term2, add2)\n       and IsConstant(add2.Term1, const2) and (const2.Value = 2)\n       and IsConstant(add2.Term2, const3) and (const3.Value = 3)\n    then\n      // everything is fine\n    else\n      raise Exception.Create(&#39;CreateAST is not working correctly!&#39;);\n  finally FreeAndNil(ast); end;\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>–ú—ã –Ω–∞–ø–∏—à–µ–º –ø—Ä–æ—Å—Ç–æ –ø–∞—Ä—Å–µ—Ä –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—Å—Ç AST –∏–∑ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–µ <code>number1 + number2 + ... numberN</code>.</p><p>–ù–∞—à &quot;—è–∑—ã–∫&quot; –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –¥–≤–∞ —Ç–æ–∫–µ–Ω–∞: &#39;number&#39; (—á–∏—Å–ª–æ) –∏ &#39;addition&#39; (—Å–ª–æ–∂–µ–Ω–∏–µ). –ü—Ä–æ–±–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–µ –≤–∞–∂–Ω—ã –±—É–¥—É—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Ç–æ–∫–∏–Ω–µ–∑–∞—Ç–æ—Ä–æ–º (–ª–µ–∫—Å–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º). –í—Å–µ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–æ–∫–µ–Ω &#39;unknown&#39;.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>type\n  TTokenKind = (tkNumber, tkAddition, tkUnknown);\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>–ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–æ —Ç–æ–∫–µ–Ω—ã:</p><ul><li>tkNumber ‚Äî &quot;\\d+&quot;</li><li>tkAddition ‚Äî &quot;+&quot;</li><li>&quot;\\s+&quot; ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è</li><li>tkUnknown ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ: &quot;[^\\d+\\s]&quot;</li></ul><p>–¢–æ–∫–∏–Ω–µ–∑–∞—Ç–æ—Ä –∏ –ø–∞—Ä—Å–µ—Ä –Ω—É–∂–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–ª–µ–¥—É—é—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:</p><ul><li>–í—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞.</li><li>–¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è.</li></ul><p>–ö–ª–∞—Å—Å <code>TStringStream</code> –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±–∞ —ç—Ç–∏ –ø—É–Ω–∫—Ç–∞ —Ç–∞–∫ —á—Ç–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>  TParserState = TStringStream;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–æ–∫–∏–Ω–µ–∑–∞—Ç–æ—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –∏ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º <code>var</code> –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç <code>True</code> –µ—Å–ª–∏ –ø–∞—Ä–∞ —Ç–æ–∫–µ–Ω\\–∑–Ω–∞—á–µ–Ω–∏–µ –±—ã–ª–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –∏ <code>False</code> –µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –∫–æ–Ω–µ—Ü –ø–æ—Ç–æ–∫–∞.</p><p>–≠—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞, –Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∫—Ä–∞–π–Ω–µ –Ω–µ–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function GetToken(state: TParserState; var token: TTokenKind; var value: string): boolean;\nvar\n  nextChar: string;\n  position: int64;\nbegin\n  repeat\n    nextChar := state.ReadString(1);\n    Result := (nextChar &lt;&gt; &#39;&#39;);\n    // Ignore whitespace\n  until (not Result) or (not nextChar[1].IsWhiteSpace);\n\n  if Result then begin\n    value := nextChar[1];\n\n    // Addition\n    if value = &#39;+&#39; then\n      token := tkAddition\n\n    // Number\n    else if value[1].IsNumber then begin\n      token := tkNumber;\n      repeat\n        position := state.Position;\n        nextChar := state.ReadString(1);\n\n        // End of stream, stop\n        if nextChar = &#39;&#39; then\n          break //repeat\n\n        // Another number, append\n        else if nextChar[1].IsNumber then\n          value := value + nextChar[1]\n\n        // Read too far, retract\n        else begin\n          state.Position := position;\n          break; //repeat\n        end;\n      until false;\n    end\n\n    // Unexpected input\n    else\n      token := tkUnknown;\n  end;\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Ç–æ–∫–∏–Ω–µ–∑–∞—Ç–æ—Ä–∞..</p><p><code>ExpectFail(state)</code> –≤—ã–∑—ã–≤–∞–µ—Ç <code>GetToken</code> –∏ –æ–∂–∏–¥–∞–µ—Ç —á—Ç–æ –æ–Ω –≤–µ—Ä–Ω—ë—Ç <code>False</code>.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure ExpectFail(state: TParserState);\nvar\n  token: TTokenKind;\n  value: string;\nbegin\n  if GetToken(state, token, value) then\n    raise Exception.Create(&#39;ExpectFail failed&#39;);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>Expect(State, token, value)</code> –≤—ã–∑—ã–≤–∞–µ—Ç <code>GetNextToken</code> –∏ –æ–∂–∏–¥–∞–µ—Ç —á—Ç–æ –æ–Ω –≤–µ—Ä–Ω—ë—Ç <code>True</code> –∏ —Ç–µ –∂–µ —Ç–æ–∫–µ–Ω/–∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure Expect(state: TParserState; expectedToken: TTokenKind;   expectedValue: string);\nvar\n  token: TTokenKind;\n  value: string;\nbegin\n  if not GetToken(state, token, value) then\n    raise Exception.Create(&#39;Expect failed&#39;)\n\n  else if token &lt;&gt; expectedToken then\n    raise Exception.CreateFmt(            &#39;Expect encountered invalid token kind (%d, expected %d)&#39;,\n            [Ord(token), Ord(expectedToken)])\n\n  else if value &lt;&gt; expectedValue then\n    raise Exception.CreateFmt(            &#39;Expect encountered invalid value (%s, expected %s)&#39;,\n            [value, expectedValue])\nend;\n\nprocedure TestGetToken;\nvar\n  state: TParserState;\nbegin\n  state := TParserState.Create(&#39;&#39;);\n  ExpectFail(state);\n  FreeAndNil(state);\n\n  state := TParserState.Create(&#39;1&#39;);\n  Expect(state, tkNumber, &#39;1&#39;);\n  ExpectFail(state);\n  FreeAndNil(state);\n\n  state := TParserState.Create(&#39;1+22 333 Ab&#39;);\n  Expect(state, tkNumber, &#39;1&#39;);\n  Expect(state, tkAddition, &#39;+&#39;);\n  Expect(state, tkNumber, &#39;22&#39;);\n  Expect(state, tkNumber, &#39;333&#39;);\n  Expect(state, tkUnknown, &#39;A&#39;);\n  Expect(state, tkUnknown, &#39;b&#39;);\n  ExpectFail(state);\n  FreeAndNil(state);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>–ü–∞—Ä—Å–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª—é–±—É—é –¥–æ–ø—É—Å—Ç–∏–º—É—é —Å—Ç—Ä–æ–∫—É –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ—ë –≤ AST.</p><p>–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞, –æ–Ω —Å–æ–∑–¥–∞—Å—Ç AST –¥–ª—è —ç—Ç–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –≤–µ—Ä–Ω—ë—Ç –µ–≥–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ <code>ast</code> –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç <code>True</code>.</p><p>–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞, –ø–∞—Ä–∞–º–µ—Ç—Ä <code>ast</code> –±—É–¥–µ—Ç <code>nil</code> –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ <code>False</code>.</p><p>–ü—É—Å—Ç–æ–π –≤–≤–æ–¥ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function Parse(const prog: string; var ast: TAST): boolean;\nvar\n  accept : TTokenKind;\n  numbers: TList;\n  state  : TParserState;\n  token  : TTokenKind;\n  value  : string;\nbegin\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>–ú—ã –º–æ–∂–µ–º –ª–µ–≥–∫–æ —É–≤–∏–¥–µ—Ç—å –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–Ω–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>   tkNumber (tkAddition tkNumber)*\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>(–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –æ–ø—É—â–µ–Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª—è)</p><p>–ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∏—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∏ –∏–∑–≤–ª–µ—á—ë—Ç –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤—Å–µ —á–∏—Å–ª–∞ –≤ <code>TArray</code>.</p><p>–í –∫–æ–Ω—Ü–µ –æ–Ω –ø–µ—Ä–µ–¥–∞—Å—Ç —ç—Ç–æ—Ç –º–∞—Å—Å–∏–≤ –≤ —Ñ—É–Ω–∫—Ü–∏—é <code>CreateAST</code> –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è AST.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>   ast := nil;\n  Result := false;\n\n  state := TParserState.Create(prog);\n  try\n    numbers := TList.Create;\n    try\n      accept := tkNumber;\n      while GetToken(state, token, value) do begin\n        if token &lt;&gt; accept then\n          Exit;\n        if accept = tkNumber then begin\n          numbers.Add(StrToInt(value));\n          accept := tkAddition;\n        end\n        else\n          accept := tkNumber;\n      end;\n\n      if accept = tkNumber then\n        // Last token in the program was tkAddition, which is not allowed.\n        Exit;\n\n      if numbers.Count &gt; 0 then begin\n        ast := CreateAST(numbers.ToArray);\n        Result := true;\n      end;\n    finally FreeAndNil(numbers); end;\n  finally FreeAndNil(state); end;\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>–ù–∞–º –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤...</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure TestParse;\nvar\n  add1  : TAddition;\n  add2  : TAddition;\n  ast   : TAST;\n  const1: TConstant;\n  const2: TConstant;\n  const3: TConstant;\nbegin\n  if not Parse(&#39;1+2 + 3&#39;, ast) then\n    raise Exception.Create(&#39;Parser failed&#39;);\n  try\n    if assigned(ast)\n       and IsAddition(ast, add1)\n       and IsConstant(add1.Term1, const1) and (const1.Value = 1)\n       and IsAddition(add1.Term2, add2)\n       and IsConstant(add2.Term1, const2) and (const2.Value = 2)\n       and IsConstant(add2.Term2, const3) and (const3.Value = 3)\n    then\n      // everything is fine\n    else\n      raise Exception.Create(&#39;CreateAST is not working correctly!&#39;);\n  finally FreeAndNil(ast); end;\n\n  if Parse(&#39;1+2 +&#39;, ast) then begin\n    if assigned(ast) then\n      raise Exception.Create(&#39;Invalid program resulted in an AST!)&#39;)\n    else\n      raise Exception.Create(&#39;Invalid program compiled into an empty AST!&#39;);\n  end;\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>–î–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ AST –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é —Ä–µ–∫—É—Ä—Å–∏—é.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function InterpretAST(ast: TAST): integer;\nvar\n  add1  : TAddition;\n  const1: TConstant;\nbegin\n  if not assigned(ast) then\n    raise Exception.Create(&#39;Result is undefined!&#39;);\n  // Alternatively, we could use Nullable as result, \n  // with Nullable.Null as a default value.\n\n  if IsConstant(ast, const1) then\n    Result := const1.Value\n  else if IsAddition(ast, add1) then\n    Result := InterpretAST(add1.Term1) + InterpretAST(add1.Term2)\n  else\n    raise Exception.Create(&#39;Internal error. Unknown AST element: &#39; +      ast.ClassName);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>–ù–µ—Å–∫–æ–ª—å–∫–æ sanity tests –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è...</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure TestInterpretAST;\n\n  procedure Test(const testName: string; const values: TArray;    expectedResult: integer);\n  var\n    ast       : TAST;\n    calcResult: integer;\n  begin\n    ast := CreateAST(values);\n    if not assigned(ast) then\n      raise Exception.CreateFmt(&#39;Compilation failed in test %s&#39;, [testName]);\n\n    try\n      calcResult := InterpretAST(ast);\n      if calcResult &lt;&gt; expectedResult then\n        raise Exception.CreateFmt(\n                &#39;Evaluation failed in test %s. &#39; +\n                &#39;Calculated result %d &lt;&gt; expected result %d&#39;,\n                [testName, calcResult, expectedResult]);\n    finally\n      FreeAndNil(ast);\n    end;\n  end;\n\nbegin\n  Test(&#39;1&#39;, [42], 42);\n  Test(&#39;2&#39;, [1, 2, 3], 6);\n  Test(&#39;3&#39;, [2, -2, 3, -3], 0);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>–î–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —ç—Ç–æ–≥–æ AST, –º—ã –¥–æ–ª–∂–Ω—ã:</p>',66),D=(0,a._)("li",null,"–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Å —Ç–∏–ø–æ–º 'constant' –≤ –∞–Ω–æ–Ω–∏–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —É–∑–ª–∞.",-1),f=(0,a._)("li",null,[(0,a.Uk)("–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Å —Ç–∏–ø–æ–º 'summation' –≤ –∞–Ω–æ–Ω–∏–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –¥–≤—É—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. "),(0,a._)("ul",null,[(0,a._)("li",null,"–ü–µ—Ä–≤—ã–π - –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ª–µ–≤–æ–≥–æ —Å–ª–∞–≥–∞–µ–º–æ–≥–æ –∏"),(0,a._)("li",null,"–≤—Ç–æ—Ä–æ–π - –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤–æ–≥–æ —Å–ª–∞–≥–∞–µ–º–æ–≥–æ")])],-1),S={href:"http://docwiki.embarcadero.com/RADStudio/Tokyo/en/Anonymous_Methods_in_Delphi#Variable_Binding_Mechanism",target:"_blank",rel:"noopener noreferrer"},B=(0,a.Uk)("–ú–µ—Ö–∞–Ω–∏–∑–º —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö"),E=(0,a.Uk)(" –∑–∞–±–æ—Ç–∏—Ç—Å—è –æ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"),R=(0,a.uE)('<div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function MakeConstant(value: integer): TFunc;\nbegin\n  Result :=\n    function: integer\n    begin\n      Result := value;\n    end;\nend;\n\nfunction MakeAddition(const term1, term2: TFunc): TFunc;\nbegin\n  Result :=\n    function: integer\n    begin\n      Result := term1() + term2();\n    end;\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>–í–∞–∂–Ω–∞—è —Ç–æ—á–∫–∞ –∑–¥–µ—Å—å –≤ —Ç–æ–º —á—Ç–æ –Ω–µ <code>MakeConstant</code> –Ω–µ <code>MakeAddition</code> –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. –û–Ω–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç –∞–Ω–æ–Ω–∏–º–Ω—ã–π –º–µ—Ç–æ–¥ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –Ω–µ–≥–æ, —á—Ç–æ –±–æ–ª–µ–µ –∏–ª–∏ –º–µ–Ω–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—é –æ–±—ä–µ–∫—Ç–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç—É –µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –Ω–æ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (variable capturing).</p><p>–ö—Å—Ç–∞—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –Ω–∞—à &quot;—è–∑—ã–∫&quot; —Ç–æ–ª—å–∫–æ –≤—ã—á–∏—Å–ª—è–µ—Ç —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —á—Ç–æ –≤—Å–µ–≥–¥–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –¥–∞—ë—Ç —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —Ç–æ &quot;—Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ&quot; –∏–ª–∏ <code>TFunc</code> —Ç–æ—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –Ω–∞—à–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.</p><p>–î–ª—è &quot;–∫–æ–º–ø–∏–ª—è—Ü–∏–∏&quot; AST –º—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∫—É—Ä—Å–∏—é —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–æ—á–µ—Ä–Ω–µ-–≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –∞–Ω–æ–Ω–∏–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º (–∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–æ–Ω–∏–º–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—á–∏—Å–ª—è—é—â–µ–π —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —É–∑–µ–ª.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>function CompileAST(ast: TTerm): TFunc;\nvar\n  add1: TAddition;\n  const1: TConstant;\nbegin\n  if IsConstant(ast, const1) then\n    // this node represents a constant\n    Result := MakeConstant(const1.Value)\n  else if IsAddition(ast, add1) then\n    // this node represent an expression\n    Result := MakeAddition(CompileAST(add1.Term1), CompileAST(add1.Term2))\n  else\n\n    raise Exception.Create(&#39;Internal error. Unknown AST element: &#39; +      ast.ClassName);\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>–≠—Ç–æ—Ç –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç <strong>–∑–Ω–∞—á–µ–Ω–∏–µ</strong> <code>const1.Value</code>, –∞ –Ω–µ —Å—Å—ã–ª–∫—É (—É–∫–∞–∑–∞—Ç–µ–ª—å) –Ω–∞ –Ω–µ–≥–æ. –û—Ç–∫—É–¥–∞ —è —ç—Ç–æ –∑–Ω–∞—é? –ü–æ—Ç–æ–º—É —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è <code>TestCompileAST</code> —è–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.</p><p>–í—ã–∑—ã–≤–∞—è <code>CompileAST(CreateAST[1,2,3])</code> –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>(*\nfunction: integer\nbegin\n  Result :=\n    (function: integer\n     begin\n       Result := 1;\n     end)()\n    +\n    (function: integer\n     begin\n       Result :=\n         (function: integer\n          begin\n            Result := 2;\n          end)()\n         +\n         (function: integer\n          begin\n            Result := 3;\n          end)();\n     end)();\n\nend;\n*)\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>(*): —è –∑–Ω–∞—é —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç —É—Ç–æ—á–∫–∞ –ø–∞–º—è—Ç–∏ —Ç–∞–∫ –∫–∞–∫ AST –Ω–µ —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è.</p><p>–¢—Ä—É–¥–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ñ–æ—Ä–º–µ, –Ω–æ –º—ã –º–æ–∂–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ—ë –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —á–∏—Å–ª–µ —Ç–µ—Å—Ç–æ–≤ –∏ –Ω–∞–¥–µ—è—Ç—Å—è —á—Ç–æ –≤—Å—ë –û–ö üòâ</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure TestCompileAST;\n\n  procedure Test(const testName: string; const prog: string; expectedResult: integer);\n  var\n    add1      : TAddition;\n    ast       : TAST;\n    calcResult: integer;\n    code      : TFunc;\n    const1    : TConstant;\n  begin\n    if not (Parse(prog, ast) and assigned(ast)) then\n      raise Exception.CreateFmt(&#39;Parser failed in test %s&#39;, [testName]);\n\n    try\n      code := CompileAST(ast);\n      if not assigned(code) then\n\n        raise Exception.CreateFmt(&#39;Compilation failed in test %s&#39;, [testName]);\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>–î–∞–≤–∞–π—Ç–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏–º—Å—è —á—Ç–æ <code>ast.Value</code> –±—ã–ª —Å–≤—è–∑–∞–Ω –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∞ –Ω–µ –ø–æ —Å—Å—ã–ª–∫–µ.</p><p>–ò–∑–º–µ–Ω–µ–Ω–∏–µ AST —Å–µ–π—á–∞—Å –Ω–µ –¥–æ–ª–∂–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>       if (IsAddition(ast, add1) and IsConstant(add1.Term1, const1))\n         or IsConstant(ast, const1)\n      then\n        const1.Value := const1.Value + 1\n      else\n        raise Exception.CreateFmt(&#39;Unexpected AST format in test %s&#39;,         [testName]);\n\n      calcResult := code(); //execute the compiled code\n\n      if calcResult &lt;&gt; expectedResult then\n        raise Exception.CreateFmt(\n                &#39;Evaluation failed in test %s. &#39; +\n                &#39;Codegen result %d &lt;&gt; expected result %d&#39;,\n                [testName, calcResult, expectedResult]);\n\n    finally\n      FreeAndNil(ast);\n    end;\n  end;\n\nbegin\n  Test(&#39;1&#39;, &#39;42&#39;, 42);\n  Test(&#39;2&#39;, &#39;1 + 2 + 3&#39;, 6);\n  Test(&#39;3&#39;, &#39;2 + 2 +3+3&#39;, 10);\n\nend;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>–ï—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, –º—ã –∑–∞–ø—É—Å—Ç–∏–º —Ü–∏–∫–ª –ß—Ç–µ–Ω–∏–µ-–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ-–í—ã–≤–æ–¥ (Read-Eval-Print Loop) —Ç–∞–∫ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—à –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>procedure RunREPL;\nvar\n  ast : TAST;\n  prog: string;\nbegin\n  repeat\n    Write(&#39;Enter an expression (empty line exits): &#39;);\n    Readln(prog);\n    if prog = &#39;&#39; then\n      break;\n\n    if not Parse(prog, ast) then\n      Writeln(&#39;Syntax is not valid&#39;)\n    else\n      Writeln(&#39;Result is: &#39;, CompileAST(ast)());\n  until false;\nend;\n\nbegin\n   try\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>–ó–∞–ø—É—Å—Ç–∏–º –≤—Å–µ –º–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã.</p><div class="language-delphi ext-delphi line-numbers-mode"><pre class="language-delphi"><code>     Writeln(&#39;Running AST creation tests ...&#39;);\n    TestCreateAST;\n\n    Writeln(&#39;Running tokenizer tests ...&#39;);\n    TestGetToken;\n\n    Writeln(&#39;Running parser test ...&#39;);\n    TestParse;\n\n    Writeln(&#39;Running AST interpreter tests ...&#39;);\n    TestInterpretAST;\n\n    Writeln(&#39;Running AST compilation tests ...&#39;);\n    TestCompileAST;\n\n    RunREPL;\n  except\n    on E: Exception do begin\n      Writeln(E.ClassName, &#39;: &#39;, E.Message);\n      Readln;\n    end;\n  end;\nend.\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div>',18),F={render:function(n,s){const e=(0,a.up)("OutboundLink");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("h1",l,[p,(0,a.Uk)(" "+(0,r.zw)(n.$frontmatter.title),1)]),(0,a._)("p",null,[i,(0,a._)("a",b,[t,(0,a.Wm)(e)]),c]),(0,a._)("p",null,[u,(0,a._)("a",m,[d,(0,a.Wm)(e)]),o]),(0,a._)("p",null,[g,(0,a._)("a",T,[h,(0,a.Wm)(e)]),v,(0,a._)("a",A,[x,(0,a.Wm)(e)]),C]),k,(0,a._)("ul",null,[D,f,(0,a._)("li",null,[(0,a._)("a",S,[B,(0,a.Wm)(e)]),E])]),R],64)}}}}]);