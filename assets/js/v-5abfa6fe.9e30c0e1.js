"use strict";(self.webpackChunkway23=self.webpackChunkway23||[]).push([[3669],{31264:(e,n,a)=>{a.r(n),a.d(n,{data:()=>s});const s={key:"v-5abfa6fe",path:"/mega-cmd.html",title:"Настройка облачного хранилища MEGA на сервере Debian без GUI",lang:"ru-RU",frontmatter:{title:"Настройка облачного хранилища MEGA на сервере Debian без GUI",date:"2023-11-11",categories:["Блог"],tags:["way23"]},excerpt:"",headers:[{level:2,title:"Ссылки",slug:"ссылки",children:[]}],filePathRelative:"mega-cmd.md",git:{updatedTime:1699648452e3}}},28997:(e,n,a)=>{a.r(n),a.d(n,{default:()=>w});var s=a(66252),r=a(3577);const l={id:"frontmatter-title",tabindex:"-1"},t=(0,s._)("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),i={href:"https://mega.io/cmd",target:"_blank",rel:"noopener noreferrer"},d=(0,s.Uk)("MEGA CMD"),c=(0,s.Uk)(" — приложение облачного хранилища MEGA для систем без графического интерфейса."),m=(0,s.uE)('<p>Для работы с MEGA CMD скачайте и установите пакет:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>user@debian-server\n:~$ wget https://mega.nz/linux/repo/Debian_12/amd64/megacmd-Debian_12_amd64.deb\nuser@debian-server:~$ sudo apt install ./megacmd-Debian_12_amd64.deb \n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>После установки, становятся доступны команды MEGA-CMD. Они все начинаются с <code>mega-</code>, наберите начало команды и нажмите два раза <code>TAB</code>, чтобы увидеть их все.</p><p>Первой командой нужно авторизоваться в MEGA:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mega-login login password\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Чтобы сбросить авторизацию используется команда:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mega-logout --keep-session\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Необязательный параметр <code>--keep-session</code> определяет сохранять ли настройки сессии, например, пути для бекапов и синхронизации, которые описаны ниже.</p><p>Чтобы сделать каталог в котором будут синхронизироваться файлы используется команда <code>mega-sync</code>.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir /home/user/MEGA\nmega-sync /home/user/MEGA /files\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Первый параметр — путь на сервере, второй — в облачном хранилище. Если запустить команду <code>mega-sync</code> без параметров, то она вернет список всех синхронизируемых путей. Для удаления пути используется параметр <code>-d</code> с идентификатором пути из списка.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mega-sync -d id\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div>',12),p=(0,s.Uk)("Для бекапов есть отдельная команда "),u=(0,s._)("code",null,"mega-backup",-1),o=(0,s.Uk)(". Она так же принимает путь на сервере и путь в облачном хранилище. В параметре "),b=(0,s._)("code",null,"--period=",-1),g=(0,s.Uk)(" устанавливается периодичность резервного копирования в формате "),v=(0,s.Uk)("cron"),x=(0,s.Uk)(". Количество хранимых копий можно передать через параметр "),h=(0,s._)("code",null,"--num-backups",-1),k=(0,s.Uk)("."),f=(0,s.uE)('<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>backup /home/user/backup /backup --period=&quot;0 0 4 * * *&quot; --num-backups=10\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Перечисленные выше команды, по сути, являются клиентами и отправляют запросы в основной сервис <code>mega-cmd-service</code>. Этот сервис не запускается автоматически при перезагрузке, поэтому требуются дополнительные настройки, чтобы он включался после запуска сервера, например, модуль для systemd:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[Unit]\nDescription=Mega-CMD systemd service\nAfter=network.target\nStartLimitIntervalSec=0\n\n[Service]\nType=simple\nRestart=on-failure\nRestartSec=1\nUser=root\nExecStart=/usr/bin/mega-cmd-server\n\n[Install]\nWantedBy=multi-user.target\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Вы можете создать его командой</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo systemctl edit --full mega-cmd.service\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>А затем включить сервис</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo systemctl start mega-cmd\nsudo systemctl enable mega-cmd\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="ссылки" tabindex="-1"><a class="header-anchor" href="#ссылки" aria-hidden="true">#</a> Ссылки</h2>',8),_={href:"https://github.com/meganz/MEGAcmd",target:"_blank",rel:"noopener noreferrer"},M=(0,s.Uk)("Репозиторий с кодом MEGA CMD"),A={href:"https://github.com/meganz/MEGAcmd/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"},E=(0,s.Uk)("MEGAcmd Readme"),G={href:"https://github.com/meganz/MEGAcmd/blob/master/UserGuide.md",target:"_blank",rel:"noopener noreferrer"},U=(0,s.Uk)("MEGAcmd User Guide"),y={href:"https://github.com/meganz/MEGAcmd/blob/master/contrib/docs/BACKUPS.md",target:"_blank",rel:"noopener noreferrer"},D=(0,s.Uk)("MEGA-BACKUPS - Backing up folders with MEGAcmd"),w={render:function(e,n){const a=(0,s.up)("OutboundLink"),w=(0,s.up)("RouterLink");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("h1",l,[t,(0,s.Uk)(" "+(0,r.zw)(e.$frontmatter.title),1)]),(0,s._)("p",null,[(0,s._)("a",i,[d,(0,s.Wm)(a)]),c]),m,(0,s._)("p",null,[p,u,o,b,g,(0,s.Wm)(w,{to:"/linux-cron.html"},{default:(0,s.w5)((()=>[v])),_:1}),x,h,k]),f,(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("a",_,[M,(0,s.Wm)(a)])]),(0,s._)("li",null,[(0,s._)("a",A,[E,(0,s.Wm)(a)])]),(0,s._)("li",null,[(0,s._)("a",G,[U,(0,s.Wm)(a)])]),(0,s._)("li",null,[(0,s._)("a",y,[D,(0,s.Wm)(a)])])])],64)}}}}]);